<!DOCTYPE html>
<html>
<head>
    <title>Dashboard</title>
    <style>
        body { font-family: Arial; background: #f4f6f9; padding: 30px; }
        .header { background: white; padding: 20px; margin-bottom: 20px; }
        .menu a { margin-right: 15px; }
    </style>
</head>
<body>

<div class="header">
    <h2>Welcome {{ user.first_name }} {{ user.last_name }}</h2>
    <p>Branch: {{ branch.name }}</p>
    <p>Academic Year: {{ academic_year.year_name }}</p>
</div>

<div class="menu">
    <a href="/subjects">Subjects</a>
    <a href="#">Teachers</a>
    <a href="#">Planning</a>
    <a href="#">Reports</a>
</div>

<h3>Dashboard</h3>
<p>System ready.</p>

</body>
</html>

@app.get("/subjects")
def subjects_page(request: Request, db: Session = Depends(get_db)):
    user_id = request.cookies.get("user_id")
    if not user_id:
        return RedirectResponse(url="/")

    user = db.query(models.User).filter(models.User.user_id == user_id).first()

    subjects = db.query(models.Subject).filter(
        models.Subject.branch_id == user.branch_id,
        models.Subject.academic_year_id == user.academic_year_id
    ).all()

    return templates.TemplateResponse("subjects.html", {
        "request": request,
        "subjects": subjects
    })

    @app.post("/subjects")
def add_subject(request: Request,
                subject_code: str = Form(...),
                subject_name: str = Form(...),
                weekly_hours: int = Form(...),
                grade: int = Form(...),
                db: Session = Depends(get_db)):

    user_id = request.cookies.get("user_id")
    if not user_id:
        return RedirectResponse(url="/")

    user = db.query(models.User).filter(models.User.user_id == user_id).first()

    new_subject = models.Subject(
        subject_code=subject_code,
        subject_name=subject_name,
        weekly_hours=weekly_hours,
        grade=grade,
        branch_id=user.branch_id,
        academic_year_id=user.academic_year_id
    )

    db.add(new_subject)
    db.commit()

    return RedirectResponse(url="/subjects", status_code=302)
